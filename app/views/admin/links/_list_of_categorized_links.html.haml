.link-category
  .category= link_to(link_category.title, [:edit, :admin, link_category])
  %ul.sortable{:id => "tree_#{link_category.id}"}
    - for link in link_category.links.sort_by(&:position)
      %li{:id => "#{dom_id(link)}"}
        .link-title
          = image_tag("#{move_loc}", :class => "icon handle")
          = link_to(link.title, [:edit, :admin, link])
        .link-options
          = feature_icon_select(link, link.title)
          = icon "Write", [:edit, :admin, link]
          = trash_icon(link, [:admin, link], "#{link.title}")
        .link-images
          = icon "Picture", [:admin, link, :images]
          = link_to link.images_count, [:admin, link, :images]
          = image_tag(link.images.sort_by(&:position).first.image.url(:icon), :class => "icon thumb") unless link.images.empty?
        .link-files
          - if link.assets_count < 1
            = icon "Document", [:new, :admin, link, :asset]
            = link_to link.assets_count, [:new, :admin, link, :asset]
          - else
            = icon "Document", [:admin, link, :assets]
            = link_to link.assets_count, [:admin, link, :assets]
        .link-status
          = link.active ? "<span class=\"green\">Approved</span>" : "<span class=\"gray\">Waiting Approval</span>"
        = clear
  - for lc in link_category.link_categories
    = render :partial => "list_of_categorized_links", :locals => {:link_category => lc}
  = sortable_element("tree_#{link_category.id}", :url => reorder_admin_links_path + "?link_category_id=#{link_category.id}", :method => :put, :loading => "$('ajax_spinner').src='#{spinner_loc}'; $('reorder_status').show();", :success => "$('ajax_spinner').src='#{ok_loc}'", :failure => "$('ajax_spinner').src='#{exclamation_loc}'", :complete => visual_effect(:fade, "reorder_status", :delay => 1))
